<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tebak Kata Indonesia</title>

<style>
body{
  font-family:Arial,sans-serif;
  background:linear-gradient(135deg,#a1ffce,#faffd1);
  text-align:center;
  padding:10px;
}
#app{
  max-width:520px;
  margin:auto;
  background:#fff;
  padding:15px;
  border-radius:15px;
  box-shadow:0 10px 20px rgba(0,0,0,.15);
}
button{
  padding:8px 12px;
  border:none;
  border-radius:8px;
  background:#ffd166;
  font-weight:bold;
  margin:4px;
}
.hidden{display:none}
.keyboard{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
}
.keyboard button{
  width:36px;
}
.word{
  font-size:28px;
  letter-spacing:6px;
  margin:10px 0;
}
.wordle-row{
  display:flex;
  justify-content:center;
}
.cell{
  width:40px;height:40px;
  border:2px solid #ccc;
  margin:2px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  font-size:22px;
}
.green{background:#06d6a0;color:#fff}
.yellow{background:#ffd166}
.gray{background:#ccc}
</style>
</head>

<body>

<h2>ğŸ® Tebak Kata Indonesia</h2>

<div id="app">

<!-- MENU -->
<div id="menu">
  <p>Halo, <b id="playerName"></b></p>
  <button onclick="startClassic()">ğŸ”¤ Classic</button>
  <button onclick="startWordle()">ğŸŸ© Wordle</button>
  <button onclick="showLeaderboard()">ğŸ† Leaderboard</button>
</div>

<!-- CLASSIC -->
<div id="classic" class="hidden">
  <p>â±ï¸ <span id="time">30</span> | â¤ï¸ <span id="lives">5</span> | â­ <span id="score">0</span></p>
  <p id="clue"></p>
  <div class="word" id="word"></div>
  <div class="keyboard" id="ckeyboard"></div>
  <p id="cmsg"></p>
  <button onclick="backMenu()">â¬… Menu</button>
</div>

<!-- WORDLE -->
<div id="wordle" class="hidden">
  <div id="grid"></div>
  <div class="keyboard" id="wkeyboard"></div>
  <p id="wmsg"></p>
  <button onclick="backMenu()">â¬… Menu</button>
</div>

<!-- LEADERBOARD -->
<div id="leaderboard" class="hidden">
  <h3>ğŸ† Leaderboard Online</h3>
  <ol id="board"></ol>
  <button onclick="backMenu()">â¬… Menu</button>
</div>

</div>

<!-- SOUND -->
<audio id="click" src="assets/click.mp3"></audio>
<audio id="win" src="assets/win.mp3"></audio>
<audio id="lose" src="assets/lose.mp3"></audio>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* ================= FIREBASE ================= */
firebase.initializeApp({
  apiKey: "AIzaSyCVwFEHv2Xv0CGoUgOkV79C5iUqCgL8G0A",
  authDomain: "tebak-kata-86624.firebaseapp.com",
  projectId: "tebak-kata-86624",
  storageBucket: "tebak-kata-86624.firebasestorage.app",
  messagingSenderId: "170123314332",
  appId: "1:170123314332:web:2b4a291cf96e653bbad959"
});
const db = firebase.firestore();

/* ================= GLOBAL ================= */
const words=[
 {w:"KOMPUTER",c:"Alat elektronik"},
 {w:"SEKOLAH",c:"Tempat belajar"},
 {w:"PROGRAM",c:"Instruksi komputer"},
 {w:"INTERNET",c:"Jaringan global"}
];
const wordleWords=["BUKU","HUJAN","ROTI","MEJA","KOPI"];

const $=id=>document.getElementById(id);
const play=id=>$(id).play?.();

let player=localStorage.getItem("player")||prompt("Nama pemain:");
localStorage.setItem("player",player);
$("playerName").textContent=player;

/* ================= MENU ================= */
function hideAll(){
 ["menu","classic","wordle","leaderboard"].forEach(id=>$(id).classList.add("hidden"));
}
function backMenu(){
 hideAll(); $("menu").classList.remove("hidden");
}

/* ================= CLASSIC MODE ================= */
let cword,guessed=[],time,lives,score=0,timer;

function startClassic(){
 hideAll(); $("classic").classList.remove("hidden");
 guessed=[]; score=0;
 nextClassic();
}

function nextClassic(){
 cword=words[Math.floor(Math.random()*words.length)];
 guessed=[]; time=30; lives=5;
 $("clue").textContent="ğŸ’¡ "+cword.c;
 $("score").textContent=score;
 updateWord();
 createClassicKeyboard();
 clearInterval(timer);
 timer=setInterval(()=>{
  time--; $("time").textContent=time;
  if(time<=0) endClassic();
 },1000);
}

function updateWord(){
 let d="";
 for(let l of cword.w){
  d+=guessed.includes(l)?l+" ":"_ ";
 }
 $("word").textContent=d;
 if(!d.includes("_")){
  play("win");
  score+=time*10;
  saveScore("classic",score);
  nextClassic();
 }
}

function createClassicKeyboard(){
 $("ckeyboard").innerHTML="";
 "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(l=>{
  let b=document.createElement("button");
  b.textContent=l;
  b.onclick=()=>{
   play("click"); b.disabled=true;
   if(cword.w.includes(l)){guessed.push(l);updateWord();}
   else{lives--; $("lives").textContent=lives; if(lives<=0) endClassic();}
  };
  $("ckeyboard").appendChild(b);
 });
}

function endClassic(){
 clearInterval(timer);
 play("lose");
 $("cmsg").textContent="ğŸ’€ Game Over";
 saveScore("classic",score);
}

/* ================= WORDLE MODE ================= */
let wAnswer,wRow,wCol,grid=[];

function startWordle(){
 hideAll(); $("wordle").classList.remove("hidden");
 wAnswer=wordleWords[Math.floor(Math.random()*wordleWords.length)];
 wRow=0;wCol=0;grid=[];
 $("grid").innerHTML=""; $("wmsg").textContent="";
 for(let r=0;r<6;r++){
  let row=document.createElement("div");row.className="wordle-row";
  let cells=[];
  for(let c=0;c<5;c++){
   let cell=document.createElement("div");cell.className="cell";
   row.appendChild(cell);cells.push(cell);
  }
  $("grid").appendChild(row);grid.push(cells);
 }
 createWordleKeyboard();
}

function createWordleKeyboard(){
 $("wkeyboard").innerHTML="";
 "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(l=>{
  let b=document.createElement("button");
  b.textContent=l;
  b.onclick=()=>{ if(wCol<5){grid[wRow][wCol].textContent=l;wCol++;} };
  $("wkeyboard").appendChild(b);
 });
 let del=document.createElement("button");
 del.textContent="âŒ«";
 del.onclick=()=>{ if(wCol>0){wCol--;grid[wRow][wCol].textContent="";} };
 $("wkeyboard").appendChild(del);

 let ok=document.createElement("button");
 ok.textContent="âœ”";
 ok.onclick=checkWord;
 $("wkeyboard").appendChild(ok);
}

function checkWord(){
 if(wCol<5) return;
 let guess="";
 for(let i=0;i<5;i++) guess+=grid[wRow][i].textContent;
 for(let i=0;i<5;i++){
  if(guess[i]===wAnswer[i]) grid[wRow][i].classList.add("green");
  else if(wAnswer.includes(guess[i])) grid[wRow][i].classList.add("yellow");
  else grid[wRow][i].classList.add("gray");
 }
 if(guess===wAnswer){
  play("win");
  $("wmsg").textContent="ğŸ‰ Menang!";
  saveScore("wordle",100);
  return;
 }
 wRow++; wCol=0;
 if(wRow===6){
  play("lose");
  $("wmsg").textContent="ğŸ’€ Jawaban: "+wAnswer;
  saveScore("wordle",0);
 }
}

/* ================= LEADERBOARD ================= */
function saveScore(mode,score){
 db.collection("leaderboard").add({
  name:player,
  mode:mode,
  score:score,
  time:firebase.firestore.FieldValue.serverTimestamp()
 });
}

function showLeaderboard(){
 hideAll(); $("leaderboard").classList.remove("hidden");
 db.collection("leaderboard")
  .orderBy("score","desc")
  .limit(10)
  .onSnapshot(snap=>{
   let h="";
   snap.forEach(d=>{
    let x=d.data();
    h+=`<li>${x.name} (${x.mode}) - ${x.score}</li>`;
   });
   $("board").innerHTML=h;
  });
}
</script>

</body>
</html>
